<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="1、Hive的DDL语法操作1.1、Hive数据库DDL操作（1）创建数据库create database db_hive2;或者create database if not exists db_hive;数据库在HDFS上的默认存储路径&#x2F;user&#x2F;hive&#x2F;warehouse&#x2F;*.db（2）显示所有数据库show databases;（3）查询数据库show  database like  ‘d">
<meta name="keywords" content="新手村">
<meta property="og:type" content="article">
<meta property="og:title" content="Hive DDL及DML语法详解">
<meta property="og:url" content="http:&#x2F;&#x2F;kanatsux.github.io&#x2F;2021&#x2F;04&#x2F;16&#x2F;Hive%20DDL%E5%8F%8ADML%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3&#x2F;index.html">
<meta property="og:site_name" content="打怪升级的司图">
<meta property="og:description" content="1、Hive的DDL语法操作1.1、Hive数据库DDL操作（1）创建数据库create database db_hive2;或者create database if not exists db_hive;数据库在HDFS上的默认存储路径&#x2F;user&#x2F;hive&#x2F;warehouse&#x2F;*.db（2）显示所有数据库show databases;（3）查询数据库show  database like  ‘d">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;image-20210416165918229.png">
<meta property="og:image" content="https:&#x2F;&#x2F;cache.yisu.com&#x2F;upload&#x2F;information&#x2F;20200214&#x2F;72&#x2F;2110.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;cache.yisu.com&#x2F;upload&#x2F;information&#x2F;20200214&#x2F;72&#x2F;2111.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;2113.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;2115.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;2118.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;2119.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;2120.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;2121.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;2122.jpg">
<meta property="og:updated_time" content="2021-04-16T09:02:55.343Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;kanatsux-imgs.oss-cn-chengdu.aliyuncs.com&#x2F;image-20210416165918229.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://kanatsux.github.io/2021/04/16/Hive DDL及DML语法详解/"/>





  <title>Hive DDL及DML语法详解 | 打怪升级的司图</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">打怪升级的司图</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">咸鱼夏夏的进阶之路</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://kanatsux.github.io/2021/04/16/Hive%20DDL%E5%8F%8ADML%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="司图">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="打怪升级的司图">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Hive DDL及DML语法详解</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-04-16T16:57:37+08:00">
                2021-04-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2.9k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="1、Hive的DDL语法操作"><a href="#1、Hive的DDL语法操作" class="headerlink" title="1、Hive的DDL语法操作"></a>1、Hive的DDL语法操作</h2><h3 id="1-1、Hive数据库DDL操作"><a href="#1-1、Hive数据库DDL操作" class="headerlink" title="1.1、Hive数据库DDL操作"></a>1.1、Hive数据库DDL操作</h3><p>（1）创建数据库<br><code>create database db_hive2;</code>或者<code>create database if not exists db_hive;</code><br>数据库在HDFS上的默认存储路径/user/hive/warehouse/*.db<br>（2）显示所有数据库<br><code>show databases;</code><br>（3）查询数据库<br><code>show  database like  ‘db_hive’;</code><br>（4）查询数据库详情<br><code>desc  database db_hive;</code><br>（5）显示数据库<br><code>desc  database  extended  db_hive;</code><br>（6）切换当前数据库<br><code>use  db_hive;</code><br>（7）删除数据库<br>#删除为空的数据控<br><code>drop  database  db_hive;</code><br>#如果删除的数据库不存在，最好采用if exists判断数据库是否存在<br><code>drop  database  if exists db_hive;</code><br>#如果数据库中有表存在，需要使用cascade强制删除数据库<br><code>drop database if exists db_hive cascade</code>;</p>
<h3 id="1-2、Hive表的DDL操作"><a href="#1-2、Hive表的DDL操作" class="headerlink" title="1.2、Hive表的DDL操作"></a>1.2、Hive表的DDL操作</h3><h4 id="1-2-1、建表语法介绍"><a href="#1-2-1、建表语法介绍" class="headerlink" title="1.2.1、建表语法介绍"></a>1.2.1、建表语法介绍</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CREATE [EXTERNAL] TABLE [IF NOT EXISTS] table_name`</span><br><span class="line">`[(col_name data_type [COMMENT col_comment], ...)]`</span><br><span class="line">`[COMMENT table_comment] 表的描述可加可不加`</span><br><span class="line">`[PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)] 分区`</span><br><span class="line">`[CLUSTERED BY (col_name, col_name, ...) 分桶`</span><br><span class="line">`[SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS]</span><br><span class="line">重点：读取文本是读一行数据，需要用分隔符分割，用来匹配表的列`</span><br><span class="line">`[ROW FORMAT row_format] row format delimited fields terminated by “分隔符”`</span><br><span class="line">`[STORED AS file_format] 存储对应的文件格式`</span><br><span class="line">`[LOCATION hdfs_path]存储在hdfs的哪个目录</span><br></pre></td></tr></table></figure>

<p><strong>字段解释说明：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE ：创建指定名称的表，如果存在报异常，可以使用 IF NOT EXISTS ：来避免这个异常。`</span><br><span class="line">`EXTERNAL：创建外部表，在建表的同时可以指定源数据的路径LOCATION：创建内部表时，会将数据移动到数据仓库指向的路径，若创建外部表不会有任何改变。在删除表时，内部表的元数据和源数据都会被删除，外部表不会删除源数据。`</span><br><span class="line">`COMMENT：为表和列增加注释`</span><br><span class="line">`PARTITIONED BY：创建分区表`</span><br><span class="line">`CLUSTERED BY：创建分桶表`</span><br><span class="line">`SORTED BY：创建排序后分桶表（不常用）`</span><br><span class="line">`STORED AS ：指定存储文件类型sequencefile（二进制序列文件）、textfile（文本）、rcfile（列式存储格式文件），如果文件数据是纯文本，可以使用STORED AS TEXTFILE。如果需要使用压缩，使用STORED AS SEQUENCEFILE`</span><br><span class="line">`LOCATION 指定表在 hdfs 上的存储位置</span><br></pre></td></tr></table></figure>

<h4 id="1-2-2、创建内部表"><a href="#1-2-2、创建内部表" class="headerlink" title="1.2.2、创建内部表"></a>1.2.2、创建内部表</h4><p>1、直接使用标准的建表语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table if not exists student11(`</span><br><span class="line">`id int,`</span><br><span class="line">`name string`</span><br><span class="line">`)`</span><br><span class="line">`row format delimited fields terminated by &apos;\t&apos;`</span><br><span class="line">`stored as textfile;</span><br></pre></td></tr></table></figure>

<p>使用文本data.txt</p>
<p>1 zhang</p>
<p>2 lisi</p>
<p>2、查询建表法:</p>
<p>通过AS查询语句完成建表：将子查询的结果存放在新表里，有数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table if not exists student1 as select id,name from student;</span><br></pre></td></tr></table></figure>

<p>3、like建表法：</p>
<p>根据已存在的表结构创建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table if not exists student2 like student;</span><br></pre></td></tr></table></figure>

<p>4、查询表的类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc formatted student;</span><br></pre></td></tr></table></figure>

<p>5、内部表的默认位置：</p>
<p>（根据自己情况来定）<br><img src="https://kanatsux-imgs.oss-cn-chengdu.aliyuncs.com/image-20210416165918229.png" alt="image-20210416165918229"><br>/user/hive_remote/warehouse/db_hive.db</p>
<p>6、将数据导入到Hive表中：</p>
<p>举列子：student11s是Hive表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data local inpath &apos;/opt/bigdata2.7/hivedata/student.txt&apos; into table student11;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-3、创建外部表"><a href="#1-2-3、创建外部表" class="headerlink" title="1.2.3、创建外部表"></a>1.2.3、创建外部表</h4><p><strong>注意：default是数据库的名</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create external table if not exists default.emp(`</span><br><span class="line">`id int,`</span><br><span class="line">`name string`</span><br><span class="line">`)`</span><br><span class="line">`row format delimited fields terminated by &apos;\t&apos;`</span><br><span class="line">`location &apos;/ opt/bigdata2.7/hivedata&apos;</span><br></pre></td></tr></table></figure>

<p>创建外部表的时候需要加上external关键字，location字段可以指定，也可以不指定，不指定的话就是使用默认目录/user/hive/warehouse</p>
<h4 id="1-2-4、内部表与外部表相互转换"><a href="#1-2-4、内部表与外部表相互转换" class="headerlink" title="1.2.4、内部表与外部表相互转换"></a>1.2.4、内部表与外部表相互转换</h4><p> 1、内部表转换为外部表</p>
<p>#把student 内部表改为外部表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table student set tblproperties(&apos;EXTERNAL&apos;=&apos;TRUE&apos;);</span><br></pre></td></tr></table></figure>

<p> 2、外部表转换成内部表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table student set tblproperties(&apos;EXTERNAL&apos;=&apos;FALSE&apos;);</span><br></pre></td></tr></table></figure>

<h4 id="1-2-5、内部表与外部表区别"><a href="#1-2-5、内部表与外部表区别" class="headerlink" title="1.2.5、内部表与外部表区别"></a>1.2.5、内部表与外部表区别</h4><p>1、建表语法不同：</p>
<p>外部表建表的时候需要加上external关键字</p>
<p>2、数据存储位置不同：</p>
<p>创建内部表的时候，会将数据移动到数据仓库指向的路径；若创建外部表，仅仅记录数据所在的路径，不对数据的位置进行任何改变。</p>
<p>2、删除表之后：</p>
<p>内部表会删除元数据，删除表的数据。</p>
<p>外部表删除之后，仅仅是把表的元数据删除了，真实的数据还在，后期还可以恢复出来。</p>
<h3 id="1-3、Hive表DDL语法经典案列"><a href="#1-3、Hive表DDL语法经典案列" class="headerlink" title="1.3、Hive表DDL语法经典案列"></a>1.3、Hive表DDL语法经典案列</h3><h4 id="1-3-1、电影案列分析"><a href="#1-3-1、电影案列分析" class="headerlink" title="1.3.1、电影案列分析"></a>1.3.1、电影案列分析</h4><p>1、数据格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">战狼1,吴京1:吴刚1:小明1,2017-08-01</span><br><span class="line">战狼2,吴京2:吴刚2:小明2,2017-08-02</span><br><span class="line">战狼3,吴京4:吴刚4:小明4,2017-08-03</span><br><span class="line">战狼4,吴京3:吴刚3:小明3,2017-08-04</span><br><span class="line">战狼5,吴京5:吴刚5:小明5,2017-08-05</span><br></pre></td></tr></table></figure>

<p>2、建表语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create table t_movie(movie_name string,actors array&lt;string&gt;,first_date string)`</span><br><span class="line">`row format delimited fields terminated by &apos;,&apos;`</span><br><span class="line">`collection items terminated by &apos;:&apos;;</span><br></pre></td></tr></table></figure>

<p>3、导入数据：</p>
<p>确保hadoop用户对该文件夹有读写权限。<br><code>load data local inpath &#39;/opt/bigdata2.7/hive/movie&#39;;</code><br><img src="https://cache.yisu.com/upload/information/20200214/72/2110.jpg" alt="13、Hive的DDL、DML语法案例实战"><br>4、查询每个电影的第二个主演：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select movie_name,actors[1] from t_movie;</span><br></pre></td></tr></table></figure>

<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-hgfz0RZZ-1579482997640)(2%E3%80%81Hive%E7%9A%84DDL%E8%AF%AD%E6%B3%95%E6%93%8D%E4%BD%9C.assets/image-20200109093038358.png)]</p>
<p>5、查询每部电影有几名主演:</p>
<p><code>select movie_name,size(actors) as num from t_movie;</code><br><img src="https://cache.yisu.com/upload/information/20200214/72/2111.jpg" alt="13、Hive的DDL、DML语法案例实战"><br>6、主演里包含吴刚5的电影</p>
<p><code>select movie_name,actors from t_movie where array_contains(actors,&#39;吴刚5&#39;);</code><br><img src="https://kanatsux-imgs.oss-cn-chengdu.aliyuncs.com/2113.jpg" alt="13、Hive的DDL、DML语法案例实战"><br><strong>解析：</strong></p>
<p>这里我们首先看到比较特殊的是主演的名字，而名字有都是string类型的，所以考虑到使用array类型，以为array存储的都是想同类型的元素。这里我们要使用collection items terminated by ‘:’,来设置指定复杂元素数据类型中元素的分隔符。</p>
<p>需要注意的是：collection items terminated by不仅是用来分隔array的，它的作用是分隔复杂数据类型里面的元素的。size内置函数是用来判断array元素的个数，array_contains()是判断array是否有这个元素。</p>
<h4 id="1-3-2、个人档案型数据建表案例："><a href="#1-3-2、个人档案型数据建表案例：" class="headerlink" title="1.3.2、个人档案型数据建表案例："></a>1.3.2、个人档案型数据建表案例：</h4><p>1、数据格式：</p>
<p>1，张三，18:male:北京</p>
<p>2，李四，19:male:南京</p>
<p>3，王五，20:male:上海</p>
<p>4，哈哈，18:male:北京</p>
<p>5，嘿嘿，12:male:成都</p>
<p>6，嘻嘻，14:male:济南</p>
<p>7，张丽，17:male:深圳</p>
<p>8，李物，19:male:重庆</p>
<p>2、建表语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create table t_user(id int,name string,info struct&lt;age:string,sex:string,addr:string&gt;)`</span><br><span class="line">`row format delimited fields terminated by &apos;,&apos;`</span><br><span class="line">`collection items terminated by &apos;:&apos;;</span><br></pre></td></tr></table></figure>

<p>3、导入数据：</p>
<p><code>load data local inpath &#39;/opt/bigdata2.7/hive/user&#39; into table t_user;</code><br><img src="https://kanatsux-imgs.oss-cn-chengdu.aliyuncs.com/2115.jpg" alt="13、Hive的DDL、DML语法案例实战"><br>4、 查询每一个人的id,名字,居住地址：</p>
<p><code>select id,name,info.addr from t_user;</code><br><img src="https://kanatsux-imgs.oss-cn-chengdu.aliyuncs.com/2118.jpg" alt="13、Hive的DDL、DML语法案例实战"><br>解析：</p>
<p>这里比较特殊的字段是18:male:北京，对应的是年龄：性别：地址，每一个都有特殊的含义，我们考虑到无法构成一个键值对，所以map不合适，array只能包含相同的元素，而年龄是int类型，地址是strin类型，所以array不合适，所以考虑struct。</p>
<h4 id="1-3-3、家庭档案数据建表案列"><a href="#1-3-3、家庭档案数据建表案列" class="headerlink" title="1.3.3、家庭档案数据建表案列"></a>1.3.3、家庭档案数据建表案列</h4><p>1、数据描述：</p>
<p>1,小明,father:张三#mother:李丽#brother:小刚,28</p>
<p>2,小鸿,father:李四#mother:王丽#brother:小志,28</p>
<p>3,小鹏,father:张物#mother:李美#brother:小英,28</p>
<p>4,张飞,father:张五#mother:李影#brother:小全,28</p>
<p>2、建表语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table t_family(id int,name string,family_mem map&lt;string,string&gt;,age int)`</span><br><span class="line">`row format delimited fields terminated by &apos;,&apos;`</span><br><span class="line">`collection items terminated by &apos;#&apos;`</span><br><span class="line">`map keys terminated by &apos;:&apos;;</span><br></pre></td></tr></table></figure>

<p>3、导入数据：</p>
<p><code>load data local inpath &#39;/opt/bigdata2.7/hive/family&#39; into table t_family;</code><br><img src="https://kanatsux-imgs.oss-cn-chengdu.aliyuncs.com/2119.jpg" alt="13、Hive的DDL、DML语法案例实战"><br>4、查看每个人的父亲：</p>
<p><code>select name,family_mem[&quot;father&quot;] from t_family;</code><br><img src="https://kanatsux-imgs.oss-cn-chengdu.aliyuncs.com/2120.jpg" alt="13、Hive的DDL、DML语法案例实战"></p>
<p>5、查看有哪些亲属关系：<br><code>select name,map_keys(family_mem),age from t_family;</code><br><img src="https://kanatsux-imgs.oss-cn-chengdu.aliyuncs.com/2121.jpg" alt="13、Hive的DDL、DML语法案例实战"><br>6、查出每个人的亲人名字：</p>
<p><code>select name,map_values(family_mem) as relations,age from t_family;</code><br><img src="https://kanatsux-imgs.oss-cn-chengdu.aliyuncs.com/2122.jpg" alt="13、Hive的DDL、DML语法案例实战"><br>7、查出每个人亲人的数量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select id,name,size(family_mem) as relation_num,age from t_family;</span><br></pre></td></tr></table></figure>

<h2 id="2、Hive的DML语法操作"><a href="#2、Hive的DML语法操作" class="headerlink" title="2、Hive的DML语法操作"></a>2、Hive的DML语法操作</h2><h3 id="2-1、修改表的结构"><a href="#2-1、修改表的结构" class="headerlink" title="2.1、修改表的结构"></a>2.1、修改表的结构</h3><h4 id="2-1-1、修改表的名称"><a href="#2-1-1、修改表的名称" class="headerlink" title="2.1.1、修改表的名称"></a>2.1.1、修改表的名称</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table student_partition1 rename to student_partition2</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2、表的结构信息"><a href="#2-1-2、表的结构信息" class="headerlink" title="2.1.2、表的结构信息"></a>2.1.2、表的结构信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">desc student_partition3;</span><br><span class="line">desc formated student_partition3;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-3、增加-修改-替换列"><a href="#2-1-3、增加-修改-替换列" class="headerlink" title="2.1.3、增加/修改/替换列"></a>2.1.3、增加/修改/替换列</h4><p>增加列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table student_partition3 add columns(address string);</span><br></pre></td></tr></table></figure>

<p>修改列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table student_partition3 change column address address_id int;</span><br></pre></td></tr></table></figure>

<p>替换列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table student_partition3 replace columns(deptno string,dname string,loc string);</span><br></pre></td></tr></table></figure>

<h4 id="2-1-4、增加-删除-查看表的分区"><a href="#2-1-4、增加-删除-查看表的分区" class="headerlink" title="2.1.4、增加/删除/查看表的分区"></a>2.1.4、增加/删除/查看表的分区</h4><p>1、添加分区:</p>
<p>（1）添加单个分区：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table student_partition1 add partition(dt=&apos;20170601&apos;);</span><br></pre></td></tr></table></figure>

<p>（2）添加多个分区：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table student_partition1 add partition(dt=&apos;20170602&apos;) partition(dt=&apos;20170603&apos;);</span><br></pre></td></tr></table></figure>

<p>2、删除分区:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table student_partition1 drop partition (dt=&apos;20170601&apos;);</span><br><span class="line">alter table student_partition1 drop partition (dt=&apos;20170601&apos;) partition (dt=&apos;20170602&apos;);</span><br></pre></td></tr></table></figure>

<p>3、查看分区:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show partitions student_partition1;</span><br></pre></td></tr></table></figure>

<h3 id="2-2、Hive表的数据导入"><a href="#2-2、Hive表的数据导入" class="headerlink" title="2.2、Hive表的数据导入"></a>2.2、Hive表的数据导入</h3><h4 id="2-2-1向表中加载数据"><a href="#2-2-1向表中加载数据" class="headerlink" title="2.2.1向表中加载数据"></a>2.2.1向表中加载数据</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">load data [local] impath &apos;datapath&apos; overwrite | into table student [partition (partcol1=val1,...)];</span><br><span class="line">load data: 表示加载数据</span><br><span class="line">local:表示从本地加载数据到hive表中；否则从HDFS加载到hive表中</span><br><span class="line">inpath: 表示加载数据的路径</span><br><span class="line">overwite：表示覆盖表中已有数据，否则表示追加</span><br><span class="line">into table:表示加载到哪张表</span><br></pre></td></tr></table></figure>

<p>普通表举例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data local inpath &apos;/opt/bigdata2.7/hive/person.txt&apos; into table person;</span><br></pre></td></tr></table></figure>

<p>分区表举例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data local inpath &apos;/opt/bigdata2.7/hive/person.txt&apos; into table person partition (dt=&quot;20190202&quot;);</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2通过查询语句向表中插入数据"><a href="#2-2-2通过查询语句向表中插入数据" class="headerlink" title="2.2.2通过查询语句向表中插入数据"></a>2.2.2通过查询语句向表中插入数据</h4><p>从指定的表中查询数据结果然后插入到目标表中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert into/overwrite table tablename select **** from tablename;</span><br><span class="line">insert into table student_partion1 partition(dt=&quot;2019-07-08&quot;) select * from tablename;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-3、查询语句中创建并加载数据（as-select）"><a href="#2-2-3、查询语句中创建并加载数据（as-select）" class="headerlink" title="2.2.3、查询语句中创建并加载数据（as select）"></a>2.2.3、查询语句中创建并加载数据（as select）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table if not exists tablename as select id,name from tablename;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-4、创建表时通过location指定加载路径"><a href="#2-2-4、创建表时通过location指定加载路径" class="headerlink" title="2.2.4、创建表时通过location指定加载路径"></a>2.2.4、创建表时通过location指定加载路径</h4><p>创建表，并指定在hdfs上的位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create table if not exists student1(`</span><br><span class="line">`id int,`</span><br><span class="line">`name string)`</span><br><span class="line">`row format delimited fields terminated by &apos;\t&apos;`</span><br><span class="line">`location &apos;/usr/hive_remote/warehouse/student1&apos;;</span><br><span class="line">create table if not exists person(`</span><br><span class="line">`id int,`</span><br><span class="line">`name string,`</span><br><span class="line">`age int,`</span><br><span class="line">`sex string`</span><br><span class="line">`)`</span><br><span class="line">`row format delimited fields terminated by &apos;,&apos;;</span><br></pre></td></tr></table></figure>

<p>上传数据文件到hdfs对应的目录中</p>
<p>在Linux中运行，注意不是hive端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -put /opt/bigdata2.7/hive/student1.txt /usr/hive_remote/warehouse/student1</span><br></pre></td></tr></table></figure>

<h4 id="2-2-5、Import数据到指定Hive表中"><a href="#2-2-5、Import数据到指定Hive表中" class="headerlink" title="2.2.5、Import数据到指定Hive表中"></a>2.2.5、Import数据到指定Hive表中</h4><p><strong>注意：</strong>先用export导出之后，再将数据导入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create table student2 like student1;</span><br><span class="line">export table student1 to &apos;/export/student1&apos;;</span><br><span class="line">import table student2 from &apos;export/student1&apos;</span><br></pre></td></tr></table></figure>

<h3 id="2-3、Hive表的导出"><a href="#2-3、Hive表的导出" class="headerlink" title="2.3、Hive表的导出"></a>2.3、Hive表的导出</h3><h4 id="2-3-1、insert导出"><a href="#2-3-1、insert导出" class="headerlink" title="2.3.1、insert导出"></a>2.3.1、insert导出</h4><p>1、将查询数据的结果导出到本地</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert overwrite local directory &apos;/opt/bigdata/export/student&apos; select * from student;</span><br></pre></td></tr></table></figure>

<p>2、将查询结构格式化的导出到本地</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">insert overwrite local directory &apos;/opt/bigdata/export/student&apos;`</span><br><span class="line">`row format delimited fields teminated by &apos;,&apos;`</span><br><span class="line">`select * from student;</span><br></pre></td></tr></table></figure>

<p>3、将查询结果导出到HDFS（没有local）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">insert overwrite  directory &apos;/user/export/student&apos;`</span><br><span class="line">`row format delimited fields terminated by &apos;,&apos;`</span><br><span class="line">`select * from student;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-2、Hadoop命令导出到本地"><a href="#2-3-2、Hadoop命令导出到本地" class="headerlink" title="2.3.2、Hadoop命令导出到本地"></a>2.3.2、Hadoop命令导出到本地</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -get /user/hive_remote/warehouse/student/student.txt /opt/bigdata2.7/data</span><br></pre></td></tr></table></figure>

<h4 id="2-3-3、Hive-Shell命令导出"><a href="#2-3-3、Hive-Shell命令导出" class="headerlink" title="2.3.3、Hive Shell命令导出"></a>2.3.3、Hive Shell命令导出</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive -e &apos;select * from default.student&apos; &gt; /opt/bigdata/data/student1.txt</span><br></pre></td></tr></table></figure>

<h4 id="2-3-4、export导出到HDFS"><a href="#2-3-4、export导出到HDFS" class="headerlink" title="2.3.4、export导出到HDFS"></a>2.3.4、export导出到HDFS</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export table default.student to &apos;/user/hive/warehouse/export/student1&apos;;</span><br></pre></td></tr></table></figure>

<h1 id="3-HIve外部表和内部表的区别"><a href="#3-HIve外部表和内部表的区别" class="headerlink" title="3. HIve外部表和内部表的区别"></a>3. HIve外部表和内部表的区别</h1><p>创建表时：创建内部表时，会将数据移动到数据仓库指向的路径；若创建外部表，仅记录数据所在的路径， 不对数据的位置做任何改变。</p>
<p>删除表时：在删除表的时候，内部表的元数据和数据会被一起删除， 而外部表只删除元数据，不删除数据。这样外部表相对来说更加安全些，数据组织也更加灵活，方便共享源数据。</p>
<p>1.未被external修饰的是内部表【managed table】，被external修饰的为外部表【external table】。</p>
<p>2.内部表数据由Hive自身管理，外部表数据由HDFS管理。</p>
<p>3.内部表数据存储在hive.metastore.warehouse.dir【默认:/user/hive/warehouse】，外部表数据存储位置由用户自己决定。</p>
<p>4.删除内部表会直接删除元数据【metadata】及存储数据，删除外部表仅仅删除元数据，HDFS上的文件不会被删除。</p>
<p>5.对内部表的修改会直接同步到元数据，而对外部表的表结构和分区进行修改，则需要修改【MSCK REPAIR TABLE table_name】。</p>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    司图
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://kanatsux.github.io/2021/04/16/Hive%20DDL%E5%8F%8ADML%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3/" title="Hive DDL及DML语法详解">http://kanatsux.github.io/2021/04/16/Hive%20DDL%E5%8F%8ADML%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    
    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
      
    </div>

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/04/01/%E5%B9%BF%E6%92%AD%E5%89%A7%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86%E7%82%B9/" rel="next" title="广播剧理论知识点">
                <i class="fa fa-chevron-left"></i> 广播剧理论知识点
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/04/16/Hive%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E8%A1%A8%E7%B1%BB%E5%9E%8B%E8%AF%B4%E6%98%8E/" rel="prev" title="Hive数据结构及表类型说明">
                Hive数据结构及表类型说明 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="司图" />
            
              <p class="site-author-name" itemprop="name">司图</p>
              <p class="site-description motion-element" itemprop="description">既然进来了，就喝杯茶吧！</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
                
              
                  <span class="site-state-item-count">47</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/kanatsux" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:wowoohi@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://lauyuenn.gitee.io/lauyuenn_blog/" title="傻朝夕" target="_blank">傻朝夕</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://fakecola.gitee.io/" title="邪恶的产品万图" target="_blank">邪恶的产品万图</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、Hive的DDL语法操作"><span class="nav-number">1.</span> <span class="nav-text">1、Hive的DDL语法操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1、Hive数据库DDL操作"><span class="nav-number">1.1.</span> <span class="nav-text">1.1、Hive数据库DDL操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2、Hive表的DDL操作"><span class="nav-number">1.2.</span> <span class="nav-text">1.2、Hive表的DDL操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1、建表语法介绍"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.2.1、建表语法介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2、创建内部表"><span class="nav-number">1.2.2.</span> <span class="nav-text">1.2.2、创建内部表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-3、创建外部表"><span class="nav-number">1.2.3.</span> <span class="nav-text">1.2.3、创建外部表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-4、内部表与外部表相互转换"><span class="nav-number">1.2.4.</span> <span class="nav-text">1.2.4、内部表与外部表相互转换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-5、内部表与外部表区别"><span class="nav-number">1.2.5.</span> <span class="nav-text">1.2.5、内部表与外部表区别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3、Hive表DDL语法经典案列"><span class="nav-number">1.3.</span> <span class="nav-text">1.3、Hive表DDL语法经典案列</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-1、电影案列分析"><span class="nav-number">1.3.1.</span> <span class="nav-text">1.3.1、电影案列分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-2、个人档案型数据建表案例："><span class="nav-number">1.3.2.</span> <span class="nav-text">1.3.2、个人档案型数据建表案例：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-3、家庭档案数据建表案列"><span class="nav-number">1.3.3.</span> <span class="nav-text">1.3.3、家庭档案数据建表案列</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、Hive的DML语法操作"><span class="nav-number">2.</span> <span class="nav-text">2、Hive的DML语法操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1、修改表的结构"><span class="nav-number">2.1.</span> <span class="nav-text">2.1、修改表的结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1、修改表的名称"><span class="nav-number">2.1.1.</span> <span class="nav-text">2.1.1、修改表的名称</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2、表的结构信息"><span class="nav-number">2.1.2.</span> <span class="nav-text">2.1.2、表的结构信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3、增加-修改-替换列"><span class="nav-number">2.1.3.</span> <span class="nav-text">2.1.3、增加/修改/替换列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-4、增加-删除-查看表的分区"><span class="nav-number">2.1.4.</span> <span class="nav-text">2.1.4、增加/删除/查看表的分区</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2、Hive表的数据导入"><span class="nav-number">2.2.</span> <span class="nav-text">2.2、Hive表的数据导入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1向表中加载数据"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.2.1向表中加载数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2通过查询语句向表中插入数据"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2.2通过查询语句向表中插入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-3、查询语句中创建并加载数据（as-select）"><span class="nav-number">2.2.3.</span> <span class="nav-text">2.2.3、查询语句中创建并加载数据（as select）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-4、创建表时通过location指定加载路径"><span class="nav-number">2.2.4.</span> <span class="nav-text">2.2.4、创建表时通过location指定加载路径</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-5、Import数据到指定Hive表中"><span class="nav-number">2.2.5.</span> <span class="nav-text">2.2.5、Import数据到指定Hive表中</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3、Hive表的导出"><span class="nav-number">2.3.</span> <span class="nav-text">2.3、Hive表的导出</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1、insert导出"><span class="nav-number">2.3.1.</span> <span class="nav-text">2.3.1、insert导出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2、Hadoop命令导出到本地"><span class="nav-number">2.3.2.</span> <span class="nav-text">2.3.2、Hadoop命令导出到本地</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3、Hive-Shell命令导出"><span class="nav-number">2.3.3.</span> <span class="nav-text">2.3.3、Hive Shell命令导出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-4、export导出到HDFS"><span class="nav-number">2.3.4.</span> <span class="nav-text">2.3.4、export导出到HDFS</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-HIve外部表和内部表的区别"><span class="nav-number"></span> <span class="nav-text">3. HIve外部表和内部表的区别</span></a></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">司图</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">507.5k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>
